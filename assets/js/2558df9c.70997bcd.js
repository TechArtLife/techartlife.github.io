"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[9119],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>d});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),m=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=m(e.components);return r.createElement(s.Provider,{value:n},e.children)},f="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),f=m(t),u=a,d=f["".concat(s,".").concat(u)]||f[u]||c[u]||o;return t?r.createElement(d,l(l({ref:n},p),{},{components:t})):r.createElement(d,l({ref:n},p))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=u;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[f]="string"==typeof e?e:a,l[1]=i;for(var m=2;m<o;m++)l[m]=t[m];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5993:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>m});var r=t(7462),a=(t(7294),t(3905));const o={title:"4.\u7269\u4f53\u53d8\u6362",date:"2015-05-01T22:12:03.284Z",description:"\u3010\u56fe\u5f62\u5b66\u3011OpenGL-4-\u7269\u4f53\u7684\u53d8\u6362\u7ec4\u4ef6-Transform"},l="\u7269\u4f53\u53d8\u6362",i={unversionedId:"GameDev/Other/OpenGL/transform",id:"GameDev/Other/OpenGL/transform",title:"4.\u7269\u4f53\u53d8\u6362",description:"\u3010\u56fe\u5f62\u5b66\u3011OpenGL-4-\u7269\u4f53\u7684\u53d8\u6362\u7ec4\u4ef6-Transform",source:"@site/docs/GameDev/Other/OpenGL/4-transform.md",sourceDirName:"GameDev/Other/OpenGL",slug:"/GameDev/Other/OpenGL/transform",permalink:"/docs/GameDev/Other/OpenGL/transform",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"4.\u7269\u4f53\u53d8\u6362",date:"2015-05-01T22:12:03.284Z",description:"\u3010\u56fe\u5f62\u5b66\u3011OpenGL-4-\u7269\u4f53\u7684\u53d8\u6362\u7ec4\u4ef6-Transform"},sidebar:"tutorialSidebar",previous:{title:"3.\u7ed8\u5236\u56fe\u7247",permalink:"/docs/GameDev/Other/OpenGL/draw-image"},next:{title:"5.\u81ea\u7531\u79fb\u52a8\u7684\u76f8\u673a",permalink:"/docs/opengl-learn-5-camera"}},s={},m=[{value:"0.\u53d8\u6362\u7ec4\u4ef6",id:"0\u53d8\u6362\u7ec4\u4ef6",level:2},{value:"1.\u51c6\u5907\u6570\u636e",id:"1\u51c6\u5907\u6570\u636e",level:2},{value:"2.\u6e32\u67d3\u8fc7\u7a0b",id:"2\u6e32\u67d3\u8fc7\u7a0b",level:2},{value:"3.\u7ed3\u679c\u5c55\u793a",id:"3\u7ed3\u679c\u5c55\u793a",level:2}],p={toc:m},f="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(f,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u7269\u4f53\u53d8\u6362"},"\u7269\u4f53\u53d8\u6362"),(0,a.kt)("h2",{id:"0\u53d8\u6362\u7ec4\u4ef6"},"0.\u53d8\u6362\u7ec4\u4ef6"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Transform"),"\u7ec4\u4ef6\u7528\u6765\u63cf\u8ff0\u7269\u4f53\u5728\u573a\u666f\u4e2d\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u81ea\u8eab\uff08Model\uff09")," \u51e0\u4f55\u53d8\u6362\u4fe1\u606f\u3002\u7531\u4e09\u90e8\u5206\u6570\u636e\u7ec4\u6210\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4f4d\u7f6e ",(0,a.kt)("inlineCode",{parentName:"li"},"Position")),(0,a.kt)("li",{parentName:"ul"},"\u65cb\u8f6c ",(0,a.kt)("inlineCode",{parentName:"li"},"Rotation")),(0,a.kt)("li",{parentName:"ul"},"\u7f29\u653e ",(0,a.kt)("inlineCode",{parentName:"li"},"Scale"))),(0,a.kt)("h2",{id:"1\u51c6\u5907\u6570\u636e"},"1.\u51c6\u5907\u6570\u636e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u521b\u5efaActor")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u6dfb\u52a0Transform\u7ec4\u4ef6"),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"Actor-Component\u67b6\u6784\u975e\u5e38\u65b9\u4fbf\u3002")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-python"},"def init(self):\n    transform_comp = TransformComponent()\n    transform_comp.position = glm.vec3(0, 0, 0)\n    transform_comp.rotation = glm.vec3(0, 0, 1.0)\n    transform_comp.scale = glm.vec3(0.5, 0.5, 0.5)\n    transform_comp.update_matrix()\n    self._main_actor.add_component(transform_comp)\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5728vs shader\u4e2d\u6dfb\u52a0uniform transform"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-glsl"},"\n#version 330\nlayout (location = 0) in vec3 aPos;\nlayout (location = 1) in vec3 aColor;\nlayout (location = 2) in vec2 aTexCoord;\n\nuniform mat4 transform;\n\nout vec3 ourColor;\nout vec2 TexCoord;\n\nvoid main()\n{\n    gl_Position = transform * vec4(aPos, 1.0);\n    ourColor = aColor;\n    TexCoord = aTexCoord;\n}\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u7ed1\u5b9aTransform\u77e9\u9635\u5230Shader\u7684transform\u4e0a"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-python"},"mat_comp.bind_param('transform', 'mat4', transform_comp)\n"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5728Game\u7684update\u4e2d\u66f4\u65b0transform\u7684position, rotation, scale\u4fe1\u606f\uff0c\u66f4\u65b0transform\u77e9\u9635\u4fe1\u606f\u3002"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-python"},"def __init__(self, title='') -> None:\n    self._title: str = title\n    self._is_running: bool = False\n    self._main_window: Window = None\n    self._asset_manager: AssetManager = None\n    self._main_actor: Actor = None\n\n    self._frame_time = 0\n    self._last_frame_time_point = 0\n\n    self.pos_index = 0\n    self.pos_flag = 1\n    self.rotation_index = 0\n    self.scale_index = 0\n    self.scale_flag = 1    \n\ndef _update(self):\n    cur_time_point = time.perf_counter_ns() / 1000000  # ns -> ms\n    self._frame_time = cur_time_point - self._last_frame_time_point\n    self._last_frame_time_point = cur_time_point\n\n    frame_time_ms = round(self._frame_time, 2)\n    self._main_window.set_title(self._title + ' ' + str(frame_time_ms) + 'ms')\n\n    transform: TransformComponent = self._main_actor.get_component('TransformComponent')\n    transform.position = glm.vec3(self.pos_index, 0, 0)\n    transform.angle = - self.rotation_index\n    transform.scale = glm.vec3((self.scale_index % 150) * 0.01)\n    transform.update_matrix()\n    self._main_actor.update()\n\n    if self.scale_index >= 149:  # \u6ce8\u610f\uff1a\u8fd9\u91cc\u6bd4\u4e0a\u9762\u5c0f1\u3002\u56e0\u4e3a\u7b49\u4e8e\u65f6\uff0cscale\u4f1a\u7a81\u53d8\u4e3a0\n        self.scale_flag = -1\n    elif self.scale_index <= 20:\n        self.scale_flag = 1\n    self.scale_index += self.scale_flag * 0.07 * self._frame_time\n\n    if self.pos_index - 1.0 > 0.001:\n        self.pos_index = 1.0\n        self.pos_flag = -1\n    elif self.pos_index + 1.0 < -0.001:\n        self.pos_index = -1.0\n        self.pos_flag = 1\n    self.pos_index += self.pos_flag * 0.001 * self._frame_time\n\n    self.rotation_index += 1 * 0.08 * self._frame_time\n")))),(0,a.kt)("h2",{id:"2\u6e32\u67d3\u8fc7\u7a0b"},"2.\u6e32\u67d3\u8fc7\u7a0b"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5728MeshRenderer\u7684render\u4e2d\u6dfb\u52a0\u6750\u8d28Material\u7684uniform\u7ed1\u5b9a\u8fc7\u7a0b\u3002\u5c06mat\u4e2d\u7684\u53c2\u6570\u4f20\u9012\u5230shader\u4e2d\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u548c\u300a3.\u7ed8\u5236\u56fe\u7247\u300b\u4e2d\u8fc7\u7a0b\u76f8\u540c\u3002")),(0,a.kt)("h2",{id:"3\u7ed3\u679c\u5c55\u793a"},"3.\u7ed3\u679c\u5c55\u793a"),(0,a.kt)("p",null,'[video width="1602" height="1262" mp4="https://techartlife.com/wp-content/uploads/2022/01/LearnOpenGL.4.mp4"][/video]'))}c.isMDXComponent=!0}}]);